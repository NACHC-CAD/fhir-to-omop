package external.examples;

public class BadQueryFromEtlSynthea {

	public static void main(String[] args) {
		String sql = "insert into etl_synthea_1k.condition_occurrence (\ncondition_occurrence_id,\nperson_id,\ncondition_concept_id,\ncondition_start_date,\ncondition_start_datetime,\ncondition_end_date,\ncondition_end_datetime,\ncondition_type_concept_id,\nstop_reason,\nprovider_id,\nvisit_occurrence_id,\nvisit_detail_id,\ncondition_source_value,\ncondition_source_concept_id,\ncondition_status_source_value,\ncondition_status_concept_id\n)\nselect\nrow_number()over(order by p.person_id)     condition_occurrence_id,\np.person_id                                person_id,\nsrctostdvm.target_concept_id               condition_concept_id,\nc.start                                    condition_start_date,\nc.start                                    condition_start_datetime,\nc.stop                                     condition_end_date,\nc.stop                                     condition_end_datetime,\n38000175                                   condition_type_concept_id,\ncast(null as varchar)                      stop_reason,\npr.provider_id                             provider_id,\nfv.visit_occurrence_id_new                 visit_occurrence_id,\nfv.visit_occurrence_id_new + 1000000       visit_detail_id,\nc.code                                     condition_source_value,\nsrctosrcvm.source_concept_id               condition_source_concept_id,\nnull                                       condition_status_source_value,\n0                                          condition_status_concept_id\nfrom etl_synthea_1k_synthea_native.conditions c\njoin etl_synthea_1k.source_to_standard_vocab_map srctostdvm\n  on srctostdvm.source_code             = c.code\n and srctostdvm.target_domain_id        = 'Condition'\n and srctostdvm.target_vocabulary_id    = 'SNOMED'\n and srctostdvm.source_vocabulary_id    = 'SNOMED'\n and srctostdvm.target_standard_concept = 'S'\n and srctostdvm.target_invalid_reason is null\njoin etl_synthea_1k.source_to_source_vocab_map srctosrcvm\n  on srctosrcvm.source_code             = c.code\n and srctosrcvm.source_vocabulary_id    = 'SNOMED'\n and srctosrcvm.source_domain_id        = 'Condition'\nleft join etl_synthea_1k.final_visit_ids fv\n  on fv.encounter_id                    = c.encounter\nleft join etl_synthea_1k_synthea_native.encounters e\n  on c.encounter                        = e.id\n and c.patient                          = e.patient\nleft join etl_synthea_1k.provider pr \n  on e.provider                         = pr.provider_source_value\njoin etl_synthea_1k.person p\n  on c.patient                          = p.person_source_value\n;\n";
		System.out.println(sql);
	}
	
}

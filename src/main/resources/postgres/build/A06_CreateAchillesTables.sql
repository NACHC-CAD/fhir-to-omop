/**
 * This file was generated by deploying WebAPI and then running:
 * 
 * http://localhost:8080/WebAPI/ddl/results?dialect=postgresql&schema=@achillesResultsDbName&vocabSchema=<dbName>&tempSchema=<dbName>_ach_tmp&initConceptHierarchy=true
 * 
 * Then running that script, then running Achilles to generate the missing results tables (e.g. achilles_results).  
 * 
 * Then the following was run to generate this script:
 * pg_dump -U postgres -d OHDSI -s -t cdm_f2o_build_ach_res.*
 * 
 * Then the hardcoded schemaname was then replaced with @achillesResultsDbName
 * 
 */


--
-- PostgreSQL database dump
--

-- Dumped from database version 15.1
-- Dumped by pg_dump version 15.1

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: achilles_analysis; Type: TABLE; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE TABLE @achillesResultsDbName.achilles_analysis (
    analysis_id integer,
    analysis_name text,
    stratum_1_name text,
    stratum_2_name text,
    stratum_3_name text,
    stratum_4_name text,
    stratum_5_name text,
    is_default text,
    category text
);


ALTER TABLE @achillesResultsDbName.achilles_analysis OWNER TO ohdsi_admin_user;

--
-- Name: achilles_results; Type: TABLE; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE TABLE @achillesResultsDbName.achilles_results (
    analysis_id integer,
    stratum_1 character varying,
    stratum_2 character varying,
    stratum_3 character varying,
    stratum_4 character varying,
    stratum_5 character varying,
    count_value bigint
);


ALTER TABLE @achillesResultsDbName.achilles_results OWNER TO ohdsi_admin_user;

--
-- Name: achilles_results_dist; Type: TABLE; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE TABLE @achillesResultsDbName.achilles_results_dist (
    analysis_id integer,
    stratum_1 character varying,
    stratum_2 character varying,
    stratum_3 character varying,
    stratum_4 character varying,
    stratum_5 character varying,
    count_value bigint,
    min_value numeric,
    max_value numeric,
    avg_value numeric,
    stdev_value numeric,
    median_value numeric,
    p10_value numeric,
    p25_value numeric,
    p75_value numeric,
    p90_value numeric
);


ALTER TABLE @achillesResultsDbName.achilles_results_dist OWNER TO ohdsi_admin_user;

--
-- Name: cc_results; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cc_results (
    type character varying(255) NOT NULL,
    fa_type character varying(255) NOT NULL,
    cc_generation_id bigint NOT NULL,
    analysis_id integer,
    analysis_name character varying(1000),
    covariate_id bigint,
    covariate_name character varying(1000),
    strata_id bigint,
    strata_name character varying(1000),
    time_window character varying(255),
    concept_id integer NOT NULL,
    count_value bigint,
    avg_value double precision,
    stdev_value double precision,
    min_value double precision,
    p10_value double precision,
    p25_value double precision,
    median_value double precision,
    p75_value double precision,
    p90_value double precision,
    max_value double precision,
    cohort_definition_id bigint,
    aggregate_id integer,
    aggregate_name character varying(1000),
    missing_means_zero integer
);


ALTER TABLE @achillesResultsDbName.cc_results OWNER TO postgres;

--
-- Name: cohort; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort (
    cohort_definition_id integer NOT NULL,
    subject_id bigint NOT NULL,
    cohort_start_date date NOT NULL,
    cohort_end_date date NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort OWNER TO postgres;

--
-- Name: cohort_cache; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_cache (
    design_hash integer NOT NULL,
    subject_id bigint NOT NULL,
    cohort_start_date date NOT NULL,
    cohort_end_date date NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_cache OWNER TO postgres;

--
-- Name: cohort_censor_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_censor_stats (
    cohort_definition_id integer NOT NULL,
    lost_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_censor_stats OWNER TO postgres;

--
-- Name: cohort_censor_stats_cache; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_censor_stats_cache (
    design_hash integer NOT NULL,
    lost_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_censor_stats_cache OWNER TO postgres;

--
-- Name: cohort_inclusion; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_inclusion (
    cohort_definition_id integer NOT NULL,
    design_hash integer,
    rule_sequence integer NOT NULL,
    name character varying(255),
    description character varying(1000)
);


ALTER TABLE @achillesResultsDbName.cohort_inclusion OWNER TO postgres;

--
-- Name: cohort_inclusion_result; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_inclusion_result (
    cohort_definition_id integer NOT NULL,
    mode_id integer NOT NULL,
    inclusion_rule_mask bigint NOT NULL,
    person_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_inclusion_result OWNER TO postgres;

--
-- Name: cohort_inclusion_result_cache; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_inclusion_result_cache (
    design_hash integer NOT NULL,
    mode_id integer NOT NULL,
    inclusion_rule_mask bigint NOT NULL,
    person_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_inclusion_result_cache OWNER TO postgres;

--
-- Name: cohort_inclusion_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_inclusion_stats (
    cohort_definition_id integer NOT NULL,
    rule_sequence integer NOT NULL,
    mode_id integer NOT NULL,
    person_count bigint NOT NULL,
    gain_count bigint NOT NULL,
    person_total bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_inclusion_stats OWNER TO postgres;

--
-- Name: cohort_inclusion_stats_cache; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_inclusion_stats_cache (
    design_hash integer NOT NULL,
    rule_sequence integer NOT NULL,
    mode_id integer NOT NULL,
    person_count bigint NOT NULL,
    gain_count bigint NOT NULL,
    person_total bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_inclusion_stats_cache OWNER TO postgres;

--
-- Name: cohort_sample_element; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_sample_element (
    cohort_sample_id integer NOT NULL,
    rank_value integer NOT NULL,
    person_id bigint NOT NULL,
    age integer,
    gender_concept_id integer
);


ALTER TABLE @achillesResultsDbName.cohort_sample_element OWNER TO postgres;

--
-- Name: cohort_summary_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_summary_stats (
    cohort_definition_id integer NOT NULL,
    mode_id integer NOT NULL,
    base_count bigint NOT NULL,
    final_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_summary_stats OWNER TO postgres;

--
-- Name: cohort_summary_stats_cache; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.cohort_summary_stats_cache (
    design_hash integer NOT NULL,
    mode_id integer NOT NULL,
    base_count bigint NOT NULL,
    final_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.cohort_summary_stats_cache OWNER TO postgres;

--
-- Name: concept_hierarchy; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.concept_hierarchy (
    concept_id integer,
    concept_name character varying(400),
    treemap character varying(20),
    concept_hierarchy_type character varying(20),
    level1_concept_name character varying(255),
    level2_concept_name character varying(255),
    level3_concept_name character varying(255),
    level4_concept_name character varying(255)
);


ALTER TABLE @achillesResultsDbName.concept_hierarchy OWNER TO postgres;

--
-- Name: feas_study_inclusion_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.feas_study_inclusion_stats (
    study_id integer NOT NULL,
    rule_sequence integer NOT NULL,
    name character varying(255) NOT NULL,
    person_count bigint NOT NULL,
    gain_count bigint NOT NULL,
    person_total bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.feas_study_inclusion_stats OWNER TO postgres;

--
-- Name: feas_study_index_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.feas_study_index_stats (
    study_id integer NOT NULL,
    person_count bigint NOT NULL,
    match_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.feas_study_index_stats OWNER TO postgres;

--
-- Name: feas_study_result; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.feas_study_result (
    study_id integer NOT NULL,
    inclusion_rule_mask bigint NOT NULL,
    person_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.feas_study_result OWNER TO postgres;

--
-- Name: heracles_analysis; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.heracles_analysis (
    analysis_id integer,
    analysis_name character varying(255),
    stratum_1_name character varying(255),
    stratum_2_name character varying(255),
    stratum_3_name character varying(255),
    stratum_4_name character varying(255),
    stratum_5_name character varying(255),
    analysis_type character varying(255)
);


ALTER TABLE @achillesResultsDbName.heracles_analysis OWNER TO postgres;

--
-- Name: heracles_heel_results; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.heracles_heel_results (
    cohort_definition_id integer,
    analysis_id integer,
    heracles_heel_warning character varying(255)
);


ALTER TABLE @achillesResultsDbName.heracles_heel_results OWNER TO postgres;

--
-- Name: heracles_periods; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.heracles_periods (
    period_id integer,
    period_order integer,
    period_name character varying(255),
    period_type character varying(50),
    period_start_date date,
    period_end_date date
);


ALTER TABLE @achillesResultsDbName.heracles_periods OWNER TO postgres;

--
-- Name: heracles_results; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.heracles_results (
    cohort_definition_id integer,
    analysis_id integer,
    stratum_1 character varying(255),
    stratum_2 character varying(255),
    stratum_3 character varying(255),
    stratum_4 character varying(255),
    stratum_5 character varying(255),
    count_value bigint,
    last_update_time timestamp without time zone DEFAULT CURRENT_DATE
);


ALTER TABLE @achillesResultsDbName.heracles_results OWNER TO postgres;

--
-- Name: heracles_results_dist; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.heracles_results_dist (
    cohort_definition_id integer,
    analysis_id integer,
    stratum_1 character varying(255),
    stratum_2 character varying(255),
    stratum_3 character varying(255),
    stratum_4 character varying(255),
    stratum_5 character varying(255),
    count_value bigint,
    min_value numeric,
    max_value numeric,
    avg_value numeric,
    stdev_value numeric,
    median_value numeric,
    p10_value numeric,
    p25_value numeric,
    p75_value numeric,
    p90_value numeric,
    last_update_time timestamp without time zone DEFAULT CURRENT_DATE
);


ALTER TABLE @achillesResultsDbName.heracles_results_dist OWNER TO postgres;

--
-- Name: ir_analysis_dist; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.ir_analysis_dist (
    analysis_id integer NOT NULL,
    target_id integer NOT NULL,
    outcome_id integer NOT NULL,
    strata_sequence integer,
    dist_type integer NOT NULL,
    total bigint NOT NULL,
    avg_value numeric NOT NULL,
    std_dev numeric NOT NULL,
    min_value integer NOT NULL,
    p10_value integer NOT NULL,
    p25_value integer NOT NULL,
    median_value integer NOT NULL,
    p75_value integer NOT NULL,
    p90_value integer NOT NULL,
    max_value integer
);


ALTER TABLE @achillesResultsDbName.ir_analysis_dist OWNER TO postgres;

--
-- Name: ir_analysis_result; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.ir_analysis_result (
    analysis_id integer NOT NULL,
    target_id integer NOT NULL,
    outcome_id integer NOT NULL,
    strata_mask bigint NOT NULL,
    person_count bigint NOT NULL,
    time_at_risk bigint NOT NULL,
    cases bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.ir_analysis_result OWNER TO postgres;

--
-- Name: ir_analysis_strata_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.ir_analysis_strata_stats (
    analysis_id integer NOT NULL,
    target_id integer NOT NULL,
    outcome_id integer NOT NULL,
    strata_sequence integer NOT NULL,
    person_count bigint NOT NULL,
    time_at_risk bigint NOT NULL,
    cases bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.ir_analysis_strata_stats OWNER TO postgres;

--
-- Name: ir_strata; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.ir_strata (
    analysis_id integer NOT NULL,
    strata_sequence integer NOT NULL,
    name character varying(255),
    description character varying(1000)
);


ALTER TABLE @achillesResultsDbName.ir_strata OWNER TO postgres;

--
-- Name: pathway_analysis_codes; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.pathway_analysis_codes (
    pathway_analysis_generation_id bigint NOT NULL,
    code bigint NOT NULL,
    name character varying(2000) NOT NULL,
    is_combo integer NOT NULL
);


ALTER TABLE @achillesResultsDbName.pathway_analysis_codes OWNER TO postgres;

--
-- Name: pathway_analysis_events; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.pathway_analysis_events (
    pathway_analysis_generation_id bigint NOT NULL,
    target_cohort_id integer NOT NULL,
    combo_id bigint NOT NULL,
    subject_id bigint NOT NULL,
    ordinal integer,
    cohort_start_date timestamp without time zone NOT NULL,
    cohort_end_date timestamp without time zone NOT NULL
);


ALTER TABLE @achillesResultsDbName.pathway_analysis_events OWNER TO postgres;

--
-- Name: pathway_analysis_paths; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.pathway_analysis_paths (
    pathway_analysis_generation_id bigint NOT NULL,
    target_cohort_id integer NOT NULL,
    step_1 bigint,
    step_2 bigint,
    step_3 bigint,
    step_4 bigint,
    step_5 bigint,
    step_6 bigint,
    step_7 bigint,
    step_8 bigint,
    step_9 bigint,
    step_10 bigint,
    count_value bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.pathway_analysis_paths OWNER TO postgres;

--
-- Name: pathway_analysis_stats; Type: TABLE; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE TABLE @achillesResultsDbName.pathway_analysis_stats (
    pathway_analysis_generation_id bigint NOT NULL,
    target_cohort_id integer NOT NULL,
    target_cohort_count bigint NOT NULL,
    pathways_count bigint NOT NULL
);


ALTER TABLE @achillesResultsDbName.pathway_analysis_stats OWNER TO postgres;

--
-- Name: hh_idx_cohort_id_analysis_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hh_idx_cohort_id_analysis_id ON @achillesResultsDbName.heracles_heel_results USING btree (cohort_definition_id, analysis_id);


--
-- Name: hr_idx_cohort_analysis_concept; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hr_idx_cohort_analysis_concept ON @achillesResultsDbName.heracles_results USING btree (cohort_definition_id, analysis_id) WHERE ((stratum_2)::text <> ''::text);


--
-- Name: hr_idx_cohort_def_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hr_idx_cohort_def_id ON @achillesResultsDbName.heracles_results USING btree (cohort_definition_id);


--
-- Name: hr_idx_cohort_def_id_dt; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hr_idx_cohort_def_id_dt ON @achillesResultsDbName.heracles_results USING btree (cohort_definition_id, last_update_time);


--
-- Name: hr_idx_cohort_id_analysis_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hr_idx_cohort_id_analysis_id ON @achillesResultsDbName.heracles_results USING btree (cohort_definition_id, analysis_id);


--
-- Name: hr_idx_cohort_id_first_res; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hr_idx_cohort_id_first_res ON @achillesResultsDbName.heracles_results USING btree (cohort_definition_id, analysis_id, count_value, stratum_1);


--
-- Name: hrd_idx_cohort_def_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hrd_idx_cohort_def_id ON @achillesResultsDbName.heracles_results_dist USING btree (cohort_definition_id);


--
-- Name: hrd_idx_cohort_def_id_dt; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hrd_idx_cohort_def_id_dt ON @achillesResultsDbName.heracles_results_dist USING btree (cohort_definition_id, last_update_time);


--
-- Name: hrd_idx_cohort_id_analysis_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hrd_idx_cohort_id_analysis_id ON @achillesResultsDbName.heracles_results_dist USING btree (cohort_definition_id, analysis_id);


--
-- Name: hrd_idx_cohort_id_first_res; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX hrd_idx_cohort_id_first_res ON @achillesResultsDbName.heracles_results_dist USING btree (cohort_definition_id, analysis_id, count_value, stratum_1);


--
-- Name: idx_ar_aid; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ar_aid ON @achillesResultsDbName.achilles_results USING btree (analysis_id);


--
-- Name: idx_ar_aid_s1; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ar_aid_s1 ON @achillesResultsDbName.achilles_results USING btree (analysis_id, stratum_1);


--
-- Name: idx_ar_aid_s1234; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ar_aid_s1234 ON @achillesResultsDbName.achilles_results USING btree (analysis_id, stratum_1, stratum_2, stratum_3, stratum_4);


--
-- Name: idx_ar_s1; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ar_s1 ON @achillesResultsDbName.achilles_results USING btree (stratum_1);


--
-- Name: idx_ar_s2; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ar_s2 ON @achillesResultsDbName.achilles_results USING btree (stratum_2);


--
-- Name: idx_ard_aid; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ard_aid ON @achillesResultsDbName.achilles_results_dist USING btree (analysis_id);


--
-- Name: idx_ard_s1; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ard_s1 ON @achillesResultsDbName.achilles_results_dist USING btree (stratum_1);


--
-- Name: idx_ard_s2; Type: INDEX; Schema: @achillesResultsDbName; Owner: ohdsi_admin_user
--

CREATE INDEX idx_ard_s2 ON @achillesResultsDbName.achilles_results_dist USING btree (stratum_2);


--
-- Name: idx_cohort_sample_element_rank; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX idx_cohort_sample_element_rank ON @achillesResultsDbName.cohort_sample_element USING btree (cohort_sample_id, rank_value);


--
-- Name: idx_heracles_periods_end_date; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX idx_heracles_periods_end_date ON @achillesResultsDbName.heracles_periods USING btree (period_end_date);


--
-- Name: idx_heracles_periods_startdate; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX idx_heracles_periods_startdate ON @achillesResultsDbName.heracles_periods USING btree (period_start_date);


--
-- Name: idx_pathway_events_combo_id; Type: INDEX; Schema: @achillesResultsDbName; Owner: postgres
--

CREATE INDEX idx_pathway_events_combo_id ON @achillesResultsDbName.pathway_analysis_events USING btree (combo_id);


--
-- PostgreSQL database dump complete
--

